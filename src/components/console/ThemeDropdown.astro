---
---

<div
    id="theme-dropdown"
    class="hidden absolute right-0 mt-2 w-[200px] rounded-lg bg-[var(--color-surface)] border border-[var(--color-stroke-tertiary)] shadow-xl z-50 overflow-hidden"
    role="menu"
    aria-hidden="true"
>
    <!-- Header -->
    <div class="flex items-center justify-between gap-1.5 px-3.5 py-2.5 border-b border-[var(--color-stroke-tertiary)]">
        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="var(--color-text-muted-secondary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-palette">
            <circle cx="13.5" cy="6.5" r=".5" fill="currentColor"/>
            <circle cx="17.5" cy="10.5" r=".5" fill="currentColor"/>
            <circle cx="8.5" cy="7.5" r=".5" fill="currentColor"/>
            <circle cx="6.5" cy="12.5" r=".5" fill="currentColor"/>
            <path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z"/>
        </svg>
        <span class="font-mono text-[11px] text-[var(--color-text-muted-secondary)] flex-1">tema</span>
        <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="var(--color-text-muted-secondary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-up">
            <path d="m18 15-6-6-6 6"/>
        </svg>
    </div>

    <!-- Options -->
    <div class="p-1.5">
        <!-- Console (Active) -->
        <button
            class="w-full flex items-center gap-2.5 px-3 py-2.5 rounded-md bg-[var(--color-stroke-tertiary)] transition-colors"
            data-theme="console"
        >
            <div class="w-2.5 h-2.5 rounded-full bg-[var(--color-accent-secondary)]"></div>
            <span class="font-mono text-xs font-medium text-[var(--color-text-primary)] flex-1 text-left">console</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="var(--color-accent-secondary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-check">
                <path d="M20 6 9 17l-5-5"/>
            </svg>
        </button>

        <!-- Favorito Oscuro -->
        <button
            class="w-full flex items-center gap-2.5 px-3 py-2.5 rounded-md hover:bg-[var(--color-stroke-tertiary)] transition-colors"
            data-theme="favorite-dark"
        >
            <div class="w-2.5 h-2.5 rounded-full bg-[var(--color-accent)]"></div>
            <span class="font-mono text-xs text-[var(--color-text-muted-secondary)] flex-1 text-left">favorito</span>
            <span class="font-mono text-[10px] text-[#555555]">oscuro</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="var(--color-accent)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-check opacity-0">
                <path d="M20 6 9 17l-5-5"/>
            </svg>
        </button>

        <!-- Favorito Claro -->
        <button
            class="w-full flex items-center gap-2.5 px-3 py-2.5 rounded-md hover:bg-[var(--color-stroke-tertiary)] transition-colors"
            data-theme="favorite-light"
        >
            <div class="w-2.5 h-2.5 rounded-full bg-[#E8612A]"></div>
            <span class="font-mono text-xs text-[var(--color-text-muted-secondary)] flex-1 text-left">favorito</span>
            <span class="font-mono text-[10px] text-[#555555]">claro</span>
        </button>
    </div>
</div>

<script>
    const dropdown = document.getElementById('theme-dropdown');
    const themeButtons = dropdown?.querySelectorAll('[data-theme]');

    // Toggle dropdown
    document.addEventListener('toggle-theme-dropdown', () => {
        dropdown?.classList.toggle('hidden');
    });

    // Close dropdown when clicking outside
    document.addEventListener('click', (event) => {
        const trigger = document.getElementById('theme-trigger');
        if (!trigger?.contains(event.target as Node) && !dropdown?.contains(event.target as Node)) {
            dropdown?.classList.add('hidden');
        }
    });

    // Handle theme selection
    themeButtons?.forEach(button => {
        button.addEventListener('click', () => {
            const theme = button.getAttribute('data-theme');
            if (theme) {
                // Update active state
                themeButtons.forEach(btn => {
                    btn.classList.remove('bg-[var(--color-stroke-tertiary)]');
                    const check = btn.querySelector('.lucide-check');
                    check?.classList.add('opacity-0');
                });
                button.classList.add('bg-[var(--color-stroke-tertiary)]');
                const check = button.querySelector('.lucide-check');
                check?.classList.remove('opacity-0');

                // Store theme
                localStorage.setItem('theme', theme);
                dropdown?.classList.add('hidden');
            }
        });
    });

    // Initialize theme
    const savedTheme = localStorage.getItem('theme') || 'console';
    themeButtons?.forEach(btn => {
        if (btn.getAttribute('data-theme') === savedTheme) {
            btn.classList.add('bg-[var(--color-stroke-tertiary)]');
            const check = btn.querySelector('.lucide-check');
            check?.classList.remove('opacity-0');
        }
    });
</script>
