const I=document.getElementById("particle-canvas"),c=I.getContext("2d"),R=80,C=180,X=.3,K=.05,Q=8,F=.95,z=2,tt=10;let x=[107,95,101],M=[255,122,66];function H(e){const s=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(s,(t,r,n,o)=>r+r+n+n+o+o);const a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return a?[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]:[0,0,0]}function N(e){return getComputedStyle(document.documentElement).getPropertyValue(e).trim()}function W(){const e=N("--color-accent"),s=N("--color-text-muted");e&&(M=H(e)),s&&(x=H(s))}const l=[];for(let e=0;e<256;e++)l[e]=e;for(let e=255;e>0;e--){const s=Math.floor(Math.random()*(e+1));[l[e],l[s]]=[l[s],l[e]]}for(let e=0;e<256;e++)l[256+e]=l[e];function U(e){return e*e*e*(e*(e*6-15)+10)}function P(e,s,a){return e+a*(s-e)}function L(e,s,a){const t=e&3,r=t<2?s:a,n=t<2?a:s;return(t&1?-r:r)+(t&2?-n:n)}function q(e,s){const a=Math.floor(e)&255,t=Math.floor(s)&255,r=e-Math.floor(e),n=s-Math.floor(s),o=U(r),i=U(n);return P(P(L(l[l[a]+t],r,n),L(l[l[a+1]+t],r-1,n),o),P(L(l[l[a]+t+1],r,n-1),L(l[l[a+1]+t+1],r-1,n-1),o),i)}let y=-9999,O=-9999,E=0,v=0,b=0,T=!1,S=0;const et=5e3,B=3e3,ot=1.2,k=30,V=40;let _=0,g=0,p=[];function G(){const e=window.devicePixelRatio||1;v=window.innerWidth,b=window.innerHeight,I.width=v*e,I.height=b*e,I.style.width=v+"px",I.style.height=b+"px",c.setTransform(e,0,0,e,0,0)}function nt(){p=[];for(let e=0;e<R;e++)p.push({x:Math.random()*v,y:Math.random()*b,vx:0,vy:0,size:z+Math.random()*(tt-z),noiseX:Math.random()*1e3,noiseY:Math.random()*1e3,baseAlpha:.3+Math.random()*.5,burstVx:0,burstVy:0,angle:e/R*Math.PI*2,collected:!1})}window.addEventListener("mousemove",e=>{y=e.clientX,O=e.clientY});document.addEventListener("mouseleave",()=>{y=-9999,O=-9999});window.addEventListener("mousedown",e=>{T=!0,S=performance.now()});window.addEventListener("mouseup",e=>{if(T){const s=performance.now()-S;if(T=!1,s<200)for(const a of p){const t=a.x-e.clientX,r=a.y-e.clientY,n=Math.sqrt(t*t+r*r);if(n<C*1.5&&n>1){const o=Q*(1-n/(C*1.5));a.burstVx=t/n*o,a.burstVy=r/n*o}}else{const a=Math.min(s/et,1),t=300*(1+a);for(let r=0;r<p.length;r++){const n=p[r];if(n.collected){n.x=e.clientX+(Math.random()-.5)*40,n.y=e.clientY+(Math.random()-.5)*40,n.collected=!1;const o=Math.random()*Math.PI*2,i=k*a*(.5+Math.random()*.8);n.burstVx=Math.cos(o)*i,n.burstVy=Math.sin(o)*i}else{const o=n.x-e.clientX,i=n.y-e.clientY,d=Math.sqrt(o*o+i*i);if(d<t&&d>1){const f=1-d/t,u=Math.atan2(i,o)+(Math.random()-.5)*.4,m=k*a*f*.5;n.burstVx=Math.cos(u)*m,n.burstVy=Math.sin(u)*m}}}}}});window.addEventListener("resize",()=>{G()});function st(e,s,a,t){for(let o=0;o<2;o++){const i=o/2*Math.PI*2;c.beginPath();for(let f=0;f<=60;f++){const u=f/60,m=_+i+u*2*Math.PI*2,w=a*u,h=e+Math.cos(m)*w,A=s+Math.sin(m)*w;f===0?c.moveTo(h,A):c.lineTo(h,A)}const d=t*.1;c.strokeStyle=`rgba(${M[0]},${M[1]},${M[2]},${d})`,c.lineWidth=.8,c.stroke()}}function Z(){c.clearRect(0,0,v,b),E+=.004;let e=0,s=0,a=0;if(T){const t=performance.now()-S;s=Math.min(t/B,1),a=s*s*s;for(const o of p)o.collected&&e++;const r=e/R;_+=.04+r*.12+s*.08;const n=20+r*130+s*20;g=P(g,n,.08)}else g*=.9;if(g>1&&y>0){const t=T?e/R:g/50;st(y,O,g,Math.min(t,1))}for(const t of p){if(t.collected)continue;t.vx=q(t.noiseX+E,t.noiseY)*X,t.vy=q(t.noiseY+E,t.noiseX)*X,(Math.abs(t.burstVx)>.01||Math.abs(t.burstVy)>.01)&&(t.vx+=t.burstVx,t.vy+=t.burstVy,t.burstVx*=F,t.burstVy*=F);const r=y-t.x,n=O-t.y,o=Math.sqrt(r*r+n*n);let i=0;if(T){if(o>1){if(o<V&&performance.now()-S>B){t.collected=!0;continue}const h=1/(1+o*o/5e3),A=1+e/R*3,j=-n/o,J=r/o,$=a*(.2+.5*h)*A;t.vx+=j*$,t.vy+=J*$;const D=ot*a*(.3+3*h)*A;t.vx+=r/o*D,t.vy+=n/o*D;const Y=.96;t.vx*=Y,t.vy*=Y}if(i=Math.min(1,a*1.5),o<V*3){const h=1-o/(V*3);i=Math.max(i,h)}}else if(o<C&&o>1){const h=K*(1-o/C);t.vx+=r/o*h,t.vy+=n/o*h,i=1-o/C}t.x+=t.vx,t.y+=t.vy,t.x<0&&(t.x=0,t.vx*=-.5),t.x>v&&(t.x=v,t.vx*=-.5),t.y<0&&(t.y=0,t.vy*=-.5),t.y>b&&(t.y=b,t.vy*=-.5);const d=Math.round(x[0]+(M[0]-x[0])*i),f=Math.round(x[1]+(M[1]-x[1])*i),u=Math.round(x[2]+(M[2]-x[2])*i),m=t.baseAlpha+(1-t.baseAlpha)*i;c.beginPath(),Math.sqrt(t.vx*t.vx+t.vy*t.vy)>2?(c.moveTo(t.x,t.y),c.lineTo(t.x-t.vx*2,t.y-t.vy*2),c.lineWidth=t.size/2,c.strokeStyle=`rgba(${d},${f},${u},${m})`,c.lineCap="round",c.stroke()):(c.arc(t.x,t.y,t.size/2,0,Math.PI*2),c.fillStyle=`rgba(${d},${f},${u},${m})`,c.fill())}if(e>0&&y>0){const t=Math.min(Math.ceil(e/4),15),r=18+e*.3+s*10;let n=M[0],o=M[1],i=M[2];for(let d=0;d<t;d++){const f=_*2+d/t*Math.PI*2,u=y+Math.cos(f)*r,m=O+Math.sin(f)*r,w=3+Math.sin(E*30+d)*1+s*2,h=.8+.2*Math.sin(E*40+d);c.beginPath(),c.arc(u,m,w,0,Math.PI*2),c.fillStyle=`rgba(${n},${o},${i},${h})`,c.fill()}}requestAnimationFrame(Z)}G();nt();W();const rt=new MutationObserver(e=>{e.forEach(s=>{s.type==="attributes"&&s.attributeName==="data-theme"&&W()})});rt.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]});requestAnimationFrame(Z);
